var React = require('react');
var RadarAction = require('../actions/RadarAction');
var xmlns = "http://www.w3.org/2000/svg";
var smilSupport = false;
if (typeof(document) !== 'undefined') smilSupport = !!document.createElementNS(xmlns, 'animateTransform').beginElement;

var selectedTextStyle = {
  fontFamily: 'Arial',
  stroke: 'none',
  fill: '#ffffff',
  fontSize: '9px',
  dominantBaseline: 'text-before-edge',
  fontWeight: 'bold'
};

var Dot = React.createClass({displayName: "Dot",
  componentWillReceiveProps: function(nextProps) {
    this._prevX = this.props.x;
    this._prevY = this.props.y;
  },
  componentDidUpdate: function() {
    if (!smilSupport) return;
    if (this._prevX === this.props.x && this._prevY === this.props.y) return;
    var el = document.createElementNS(xmlns, 'animateTransform');
    el.setAttributeNS(null, 'attributeName', 'transform');
    el.setAttributeNS(null, 'type', 'translate');
    el.setAttributeNS(null, 'dur', '1s');
    el.setAttributeNS(null, 'from', this._prevX + ',' + this._prevY);
    el.setAttributeNS(null, 'to', this.props.x + ',' + this.props.y);
    el.setAttributeNS(null, 'fill', 'freeze');
    el.setAttributeNS(null, 'begin', 'indefinite');
    el.setAttributeNS(null, 'end', 'indefinite');
    var g = this.refs.g.getDOMNode().appendChild(el);
    var animateTransforms = g.getElementsByTagName('animateTransform');
    for (var i = 0; i < animateTransforms.length; i++) {
      g.removeChild(animateTransforms[0]);
    }
    this.refs.g.getDOMNode().appendChild(el);
    el.beginElement();
  },
  _selectedCircle: function(key) {
    var circleStyle = {
      fill: 'none',
      strokeWidth: 3,
      stroke: this.props.fill
    };

    return this.props.product.id == this.props.selectedOssId ?
      React.createElement("circle", {key: key + "-circle-selected", r: "13", style: circleStyle}) : null;
  },
  _onMouseOver: function(e) {
    RadarAction.updateSelectedOss(this.props.product.id);
  },
  render: function() {
    var circleStyle = {
      fill: this.props.fill,
      stroke: this.props.fill
    };
    var textStyle = {
      fontFamily: 'Arial',
      stroke: 'none',
      fill: '#ffffff',
      textAnchor: 'middle',
      fontSize: '9px',
      fontWeight: 'bold'
    };
    if (!smilSupport || !this._prevX) {
      var transform = 'translate(' + this.props.x + ',' + this.props.y + ')';
    } else {
      var transform = 'translate(' + this._prevX + ',' + this._prevY + ')';
    }
    var key = "dot-" + this.props.num;
    return (
      React.createElement("g", {key: key, ref: "g", transform: transform}, 
        this._selectedCircle(key), 
        React.createElement("circle", {key: key + '-circle', r: "8", style: circleStyle, onMouseOver: this._onMouseOver}), 
        React.createElement("text", {key: key + '-text', y: "3", style: textStyle, onMouseOver: this._onMouseOver}, this.props.num)
      )
    );
  },

});

module.exports = Dot;

//# sourceMappingURL=data:application/json;base64,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QUFFSCxDQUFDLENBQUMsQ0FBQzs7QUFFSCxNQUFNLENBQUMsT0FBTyxHQUFHLEdBQUcsQ0FBQyIsImZpbGUiOiJjb21wb25lbnRzL0RvdC5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBSZWFjdCA9IHJlcXVpcmUoJ3JlYWN0Jyk7XG52YXIgUmFkYXJBY3Rpb24gPSByZXF1aXJlKCcuLi9hY3Rpb25zL1JhZGFyQWN0aW9uJyk7XG52YXIgeG1sbnMgPSBcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCI7XG52YXIgc21pbFN1cHBvcnQgPSBmYWxzZTtcbmlmICh0eXBlb2YoZG9jdW1lbnQpICE9PSAndW5kZWZpbmVkJykgc21pbFN1cHBvcnQgPSAhIWRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyh4bWxucywgJ2FuaW1hdGVUcmFuc2Zvcm0nKS5iZWdpbkVsZW1lbnQ7XG5cbnZhciBzZWxlY3RlZFRleHRTdHlsZSA9IHtcbiAgZm9udEZhbWlseTogJ0FyaWFsJyxcbiAgc3Ryb2tlOiAnbm9uZScsXG4gIGZpbGw6ICcjZmZmZmZmJyxcbiAgZm9udFNpemU6ICc5cHgnLFxuICBkb21pbmFudEJhc2VsaW5lOiAndGV4dC1iZWZvcmUtZWRnZScsXG4gIGZvbnRXZWlnaHQ6ICdib2xkJ1xufTtcblxudmFyIERvdCA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcbiAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wczogZnVuY3Rpb24obmV4dFByb3BzKSB7XG4gICAgdGhpcy5fcHJldlggPSB0aGlzLnByb3BzLng7XG4gICAgdGhpcy5fcHJldlkgPSB0aGlzLnByb3BzLnk7XG4gIH0sXG4gIGNvbXBvbmVudERpZFVwZGF0ZTogZnVuY3Rpb24oKSB7XG4gICAgaWYgKCFzbWlsU3VwcG9ydCkgcmV0dXJuO1xuICAgIGlmICh0aGlzLl9wcmV2WCA9PT0gdGhpcy5wcm9wcy54ICYmIHRoaXMuX3ByZXZZID09PSB0aGlzLnByb3BzLnkpIHJldHVybjtcbiAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoeG1sbnMsICdhbmltYXRlVHJhbnNmb3JtJyk7XG4gICAgZWwuc2V0QXR0cmlidXRlTlMobnVsbCwgJ2F0dHJpYnV0ZU5hbWUnLCAndHJhbnNmb3JtJyk7XG4gICAgZWwuc2V0QXR0cmlidXRlTlMobnVsbCwgJ3R5cGUnLCAndHJhbnNsYXRlJyk7XG4gICAgZWwuc2V0QXR0cmlidXRlTlMobnVsbCwgJ2R1cicsICcxcycpO1xuICAgIGVsLnNldEF0dHJpYnV0ZU5TKG51bGwsICdmcm9tJywgdGhpcy5fcHJldlggKyAnLCcgKyB0aGlzLl9wcmV2WSk7XG4gICAgZWwuc2V0QXR0cmlidXRlTlMobnVsbCwgJ3RvJywgdGhpcy5wcm9wcy54ICsgJywnICsgdGhpcy5wcm9wcy55KTtcbiAgICBlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCAnZmlsbCcsICdmcmVlemUnKTtcbiAgICBlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCAnYmVnaW4nLCAnaW5kZWZpbml0ZScpO1xuICAgIGVsLnNldEF0dHJpYnV0ZU5TKG51bGwsICdlbmQnLCAnaW5kZWZpbml0ZScpO1xuICAgIHZhciBnID0gdGhpcy5yZWZzLmcuZ2V0RE9NTm9kZSgpLmFwcGVuZENoaWxkKGVsKTtcbiAgICB2YXIgYW5pbWF0ZVRyYW5zZm9ybXMgPSBnLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdhbmltYXRlVHJhbnNmb3JtJyk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhbmltYXRlVHJhbnNmb3Jtcy5sZW5ndGg7IGkrKykge1xuICAgICAgZy5yZW1vdmVDaGlsZChhbmltYXRlVHJhbnNmb3Jtc1swXSk7XG4gICAgfVxuICAgIHRoaXMucmVmcy5nLmdldERPTU5vZGUoKS5hcHBlbmRDaGlsZChlbCk7XG4gICAgZWwuYmVnaW5FbGVtZW50KCk7XG4gIH0sXG4gIF9zZWxlY3RlZENpcmNsZTogZnVuY3Rpb24oa2V5KSB7XG4gICAgdmFyIGNpcmNsZVN0eWxlID0ge1xuICAgICAgZmlsbDogJ25vbmUnLFxuICAgICAgc3Ryb2tlV2lkdGg6IDMsXG4gICAgICBzdHJva2U6IHRoaXMucHJvcHMuZmlsbFxuICAgIH07XG5cbiAgICByZXR1cm4gdGhpcy5wcm9wcy5wcm9kdWN0LmlkID09IHRoaXMucHJvcHMuc2VsZWN0ZWRPc3NJZCA/XG4gICAgICA8Y2lyY2xlIGtleT17a2V5ICsgXCItY2lyY2xlLXNlbGVjdGVkXCJ9IHI9XCIxM1wiIHN0eWxlPXtjaXJjbGVTdHlsZX0+PC9jaXJjbGU+IDogbnVsbDtcbiAgfSxcbiAgX29uTW91c2VPdmVyOiBmdW5jdGlvbihlKSB7XG4gICAgUmFkYXJBY3Rpb24udXBkYXRlU2VsZWN0ZWRPc3ModGhpcy5wcm9wcy5wcm9kdWN0LmlkKTtcbiAgfSxcbiAgcmVuZGVyOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgY2lyY2xlU3R5bGUgPSB7XG4gICAgICBmaWxsOiB0aGlzLnByb3BzLmZpbGwsXG4gICAgICBzdHJva2U6IHRoaXMucHJvcHMuZmlsbFxuICAgIH07XG4gICAgdmFyIHRleHRTdHlsZSA9IHtcbiAgICAgIGZvbnRGYW1pbHk6ICdBcmlhbCcsXG4gICAgICBzdHJva2U6ICdub25lJyxcbiAgICAgIGZpbGw6ICcjZmZmZmZmJyxcbiAgICAgIHRleHRBbmNob3I6ICdtaWRkbGUnLFxuICAgICAgZm9udFNpemU6ICc5cHgnLFxuICAgICAgZm9udFdlaWdodDogJ2JvbGQnXG4gICAgfTtcbiAgICBpZiAoIXNtaWxTdXBwb3J0IHx8ICF0aGlzLl9wcmV2WCkge1xuICAgICAgdmFyIHRyYW5zZm9ybSA9ICd0cmFuc2xhdGUoJyArIHRoaXMucHJvcHMueCArICcsJyArIHRoaXMucHJvcHMueSArICcpJztcbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIHRyYW5zZm9ybSA9ICd0cmFuc2xhdGUoJyArIHRoaXMuX3ByZXZYICsgJywnICsgdGhpcy5fcHJldlkgKyAnKSc7XG4gICAgfVxuICAgIHZhciBrZXkgPSBcImRvdC1cIiArIHRoaXMucHJvcHMubnVtO1xuICAgIHJldHVybiAoXG4gICAgICA8ZyBrZXk9e2tleX0gcmVmPVwiZ1wiIHRyYW5zZm9ybT17dHJhbnNmb3JtfT5cbiAgICAgICAge3RoaXMuX3NlbGVjdGVkQ2lyY2xlKGtleSl9XG4gICAgICAgIDxjaXJjbGUga2V5PXtrZXkgKyAnLWNpcmNsZSd9IHI9XCI4XCIgc3R5bGU9e2NpcmNsZVN0eWxlfSBvbk1vdXNlT3Zlcj17dGhpcy5fb25Nb3VzZU92ZXJ9PjwvY2lyY2xlPlxuICAgICAgICA8dGV4dCBrZXk9e2tleSArICctdGV4dCd9IHk9XCIzXCIgc3R5bGU9e3RleHRTdHlsZX0gb25Nb3VzZU92ZXI9e3RoaXMuX29uTW91c2VPdmVyfT57dGhpcy5wcm9wcy5udW19PC90ZXh0PlxuICAgICAgPC9nPlxuICAgICk7XG4gIH0sXG5cbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IERvdDtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==